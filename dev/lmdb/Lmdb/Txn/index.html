<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Txn (lmdb.Lmdb.Txn)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">lmdb</a> &#x00BB; <a href="../index.html">Lmdb</a> &#x00BB; Txn</nav><h1>Module <code>Lmdb.Txn</code></h1><p>Series of operations on an environment performed atomically.</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>-'perm t</span></code><code> <span class="keyword">constraint</span> <span class="type-var">'perm</span> = <span>[&lt; `Read <span>| `Write</span> ]</span></code></dt><dd><p>A transaction handle. A transaction may be read-only or read-write.</p></dd></dl><dl><dt class="spec value" id="val-go"><a href="#val-go" class="anchor"></a><code><span class="keyword">val</span> go : <span><span class="type-var">'perm</span> <a href="../index.html#type-perm">perm</a></span> <span>&#45;&gt;</span> <span>?&#8288;txn:<span><span class="type-var">'perm</span> <a href="index.html#type-t">t</a></span></span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> <span>(<span><span class="type-var">'perm</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span></code></dt><dd><p><code>go perm env f</code> runs a transaction with <code>perm</code> read/write permissions in <code>env</code>.</p><p>The function <code>f txn</code> will receive the transaction handle. All changes to the environment <code>env</code> done using the transaction handle will be persisted to the environment only when <code>f</code> returns. After <code>f</code> returned, the transaction handle is invalid and should therefore not be leaked outside <code>f</code>.</p><dl><dt>returns</dt><dd><p><code>None</code> if the transaction was aborted with <code>abort</code>, and <code>Some _</code> otherwise.</p></dd></dl><dl><dt>parameter txn</dt><dd><p>Create a child transaction to <code>txn</code>. This is not supported on an <code>env</code> with <a href="../../Lmdb__Lmdb_bindings/EnvFlags/index.html#val-write_map"><code>Env.Flags.write_map</code></a>.</p><p>Here is an example incrementing a value atomically:</p><pre><code class="ml">go rw env begin fun txn -&gt;
  let v = Map.get ~txn k in
  Map.add ~txn k (v+1) ;
  v
end</code></pre></dd></dl></dd></dl><dl><dt class="spec value" id="val-abort"><a href="#val-abort" class="anchor"></a><code><span class="keyword">val</span> abort : <span><span class="type-var">_</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">_</span></code></dt><dd><p><code>abort txn</code> aborts transaction <code>txn</code> and the current <code>go</code> function, which will return <code>None</code>.</p></dd></dl><dl><dt class="spec value" id="val-env"><a href="#val-env" class="anchor"></a><code><span class="keyword">val</span> env : <span><span class="type-var">'perm</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="../Env/index.html#type-t">Env.t</a></code></dt><dd><p><code>env txn</code> returns the environment of <code>txn</code></p></dd></dl></div></body></html>