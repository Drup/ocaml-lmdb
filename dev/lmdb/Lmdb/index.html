<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Lmdb (lmdb.Lmdb)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">lmdb</a> &#x00BB; Lmdb</nav><h1>Module <code>Lmdb</code></h1><p>High level bindings for LMDB.</p><nav class="toc"><ul><li><a href="#raw-bindings">Raw bindings</a></li><li><a href="#permissions">Permissions</a></li><li><a href="#database">Database</a></li><li><a href="#error-reporting">Error reporting</a></li></ul></nav></header><aside><p>The <a href="http://www.lmdb.tech/doc/">LMDB</a> database is a fast in-file key-value store that supports ACID transactions.</p><p>These bindings attempt to expose a typesafe yet low-overhead API.</p><p>First, an environment must be opened using <a href="Env/index.html#val-create"><code>Env.create</code></a>:</p><pre><code class="ml">let env = Env.(create rw ~flags:Flags.no_subdir &quot;mydb&quot;) </code></pre><p>Now the data file <code>mydb</code> and lock file <code>mydb-lock</code> have been created in the current directory.</p><p>One environment may contain multiple named and one unnamed key-value stores. They are called <em>databases</em> in the <a href="http://www.lmdb.tech/doc/starting.html">LMDB documentation</a>, but called <em>maps</em> in these OCaml bindings.</p><p>A single <code>('keyey, 'valuealue, [&lt; `Read | `Write])</code> <a href="Map/index.html#type-t"><code>Map.t</code></a> is a key-value store mapping OCaml values of type <code>'keyey</code> to values of type <code>'valuealue</code>. Multiple values per key are supported on request.</p><p>Using <a href="Map/index.html"><code>Map</code></a>, we can open the unnamed map and add our first value:</p><pre><code class="ml">let map = Map.(open_existing nodup ~key:Conv.string ~value:Conv.string env) in
Map.put map &quot;Bactrian camel&quot; &quot;Elegant and beautiful animal with two humps.&quot;</code></pre><p><a href="Txn/index.html"><span>Transactions</span></a> and <a href="Cursor/index.html"><span>Iterators</span></a> are also available.</p></aside><section><header><h3 id="raw-bindings"><a href="#raw-bindings" class="anchor"></a>Raw bindings</h3></header><div class="spec module" id="module-Mdb"><a href="#module-Mdb" class="anchor"></a><code><span class="keyword">module</span> <a href="Mdb/index.html">Mdb</a> : <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <a href="../Lmdb__/index.html#module-Lmdb_bindings">Lmdb__.Lmdb_bindings</a></code></div></section><section><header><h3 id="permissions"><a href="#permissions" class="anchor"></a>Permissions</h3></header><aside><p>This library uses <code>[&lt; `Read | `Write ]</code> phantom types to encode the read/write permissions of environments, transactions, maps and cursors. The following values are used to request read-only or read-write permissions on environments, transactions and cursors.</p></aside><dl><dt class="spec type" id="type-perm"><a href="#type-perm" class="anchor"></a><code><span class="keyword">type</span> 'a perm</code><code> <span class="keyword">constraint</span> <span class="type-var">'a</span> = [&lt; `Read | `Write ]</code></dt></dl><dl><dt class="spec value" id="val-ro"><a href="#val-ro" class="anchor"></a><code><span class="keyword">val</span> ro : [ `Read ] <a href="index.html#type-perm">perm</a></code></dt><dd><p>Request read-only access.</p></dd></dl><dl><dt class="spec value" id="val-rw"><a href="#val-rw" class="anchor"></a><code><span class="keyword">val</span> rw : [ `Read | `Write ] <a href="index.html#type-perm">perm</a></code></dt><dd><p>Request read-write access.</p></dd></dl></section><section><header><h3 id="database"><a href="#database" class="anchor"></a>Database</h3></header><dl><dt class="spec module" id="module-Env"><a href="#module-Env" class="anchor"></a><code><span class="keyword">module</span> <a href="Env/index.html">Env</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Collection of maps stored in a single memory-mapped file.</p></dd></dl><dl><dt class="spec module" id="module-Txn"><a href="#module-Txn" class="anchor"></a><code><span class="keyword">module</span> <a href="Txn/index.html">Txn</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Series of operations on an environment performed atomically.</p></dd></dl><dl><dt class="spec module" id="module-Map"><a href="#module-Map" class="anchor"></a><code><span class="keyword">module</span> <a href="Map/index.html">Map</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Key-value maps.</p></dd></dl><dl><dt class="spec module" id="module-Cursor"><a href="#module-Cursor" class="anchor"></a><code><span class="keyword">module</span> <a href="Cursor/index.html">Cursor</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Iterators over maps.</p></dd></dl></section><section><header><h3 id="error-reporting"><a href="#error-reporting" class="anchor"></a>Error reporting</h3></header><dl><dt class="spec exception" id="exception-Exists"><a href="#exception-Exists" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Exists</span></code></dt><dd><p>Raised when adding already existing key or key-value pair to a map with <a href="../Lmdb__Lmdb_bindings/PutFlags/index.html#val-no_overwrite"><code>Map.Flags.no_overwrite</code></a> or <a href="../Lmdb__Lmdb_bindings/PutFlags/index.html#val-no_dup_data"><code>Map.Flags.no_dup_data</code></a> or when trying to <code>put ~flags:Flags.append(_dup)</code> non-sorted data.</p></dd></dl><dl><dt class="spec exception" id="exception-Not_found"><a href="#exception-Not_found" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Not_found</span></code></dt><dd><p>Raised when searching for non-existing key</p></dd></dl><dl><dt class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Error</span> <span class="keyword">of</span> int</code></dt><dd><p>Other errors are reported with <code>Invalid_arg s</code> or <code>Error n</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><code><span class="keyword">val</span> pp_error : Stdlib.Format.formatter <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_error Format.std_formatter e</code> prepares a human-readable description of the given error code <code>n</code> raised via <code>Error n</code>.</p></dd></dl><dl><dt class="spec value" id="val-version"><a href="#val-version" class="anchor"></a><code><span class="keyword">val</span> version : string * int * int * int</code></dt><dd><p><code>(name, major, minor, patch)</code></p></dd></dl></section></div></body></html>